import{b as B}from"./chunk-LXP3IOFP.js";import{a as A}from"./chunk-CZFHG23L.js";import{a as N,c as R,e as U,k as W}from"./chunk-WY3CXWCY.js";import{U as j}from"./chunk-NJQ2NFC2.js";import{B as m,F as c,G as _,Ka as T,Ma as V,Na as I,Pa as L,U as u,W as v,X as h,da as g,ea as w,fa as f,ia as M,ja as s,ka as a,la as k,ma as b,na as p,oa as r,p as x,qa as l,s as C,ta as O,u as D,ua as y,va as P,ya as S,za as E}from"./chunk-6PUXLSNH.js";function $(i,e){if(i&1){let t=b();s(0,"div",3)(1,"button",5),p("click",function(){c(t);let n=r(2),d=r();return _(d.startEdit(n.description))}),l(2,"Edit description"),a(),s(3,"button",6),p("click",function(){c(t);let n=r(2),d=r();return _(d.onDelete(n.id))}),l(4,"Delete"),a()()}}function z(i,e){if(i&1){let t=b();s(0,"div",4)(1,"label",7),l(2,"Edit description"),a(),s(3,"textarea",8),P("ngModelChange",function(n){c(t);let d=r(3);return y(d.draftDescription,n)||(d.draftDescription=n),_(n)}),a(),s(4,"div",9)(5,"button",10),p("click",function(){c(t);let n=r(3);return _(n.cancelEdit())}),l(6,"Cancel"),a(),s(7,"button",11),p("click",function(){c(t);let n=r(2),d=r();return _(d.saveDescription(n.id))}),l(8,"Save"),a()()()}if(i&2){let t=r(3);u(3),O("ngModel",t.draftDescription)}}function Y(i,e){if(i&1&&g(0,$,5,0,"div",3)(1,z,9,1,"div",4),i&2){let t=r(2);f(t.editing?1:0)}}function q(i,e){if(i&1&&(k(0,"app-destination-item",2),g(1,Y,2,1)),i&2){let t,o=e,n=r();M("destination",o)("showDetailsLink",!1),u(),f((o==null?null:o.authorId)===((t=n.profile())==null?null:t.uid)?1:-1)}}function G(i,e){i&1&&(s(0,"p",1),l(1,"Loading..."),a())}var F=class i{constructor(e){this.title=e}ngOnInit(){this.title.setTitle("Details")}route=m(I);destinationService=m(A);router=m(L);auth=m(j);profile=this.auth.profileSignal;destination$=this.route.paramMap.pipe(x(e=>e.get("id")),C(e=>!!e),D(e=>this.destinationService.getDestinationById(e)));editing=!1;draftDescription="";startEdit(e){this.draftDescription=e??"",this.editing=!0}cancelEdit(){this.editing=!1}saveDescription(e){if(!e)return;let t=this.draftDescription.trim();t&&this.destinationService.updateDescription$(e,t).subscribe({next:()=>{this.editing=!1},error:o=>alert("Update failed: "+(o?.message??"Unknown error"))})}onDelete(e){e&&confirm("Delete this destination? This can not be undone!")&&this.destinationService.deleteDestination$(e).subscribe({next:()=>this.router.navigate(["/destinations"]),error:t=>alert("Delete failed: "+(t?.message??"Unknown error"))})}static \u0275fac=function(t){return new(t||i)(v(V))};static \u0275cmp=h({type:i,selectors:[["app-destination-details"]],decls:6,vars:3,consts:[[1,"details-container"],[1,"muted"],["variant","detail",3,"destination","showDetailsLink"],[1,"owner-actions"],[1,"edit-box"],["type","button",1,"btn",3,"click"],["type","button",1,"btn","danger",3,"click"],["for","descEdit"],["id","descEdit","rows","6",3,"ngModelChange","ngModel"],[1,"actions"],["type","button",1,"btn","btn-neutral",3,"click"],["type","button",1,"btn","btn-accent",3,"click"]],template:function(t,o){if(t&1&&(s(0,"div",0)(1,"h4"),l(2,"Details"),a(),g(3,q,2,3),S(4,"async"),w(5,G,2,0,"p",1),a()),t&2){let n;u(3),f((n=E(4,1,o.destination$))?3:5,n)}},dependencies:[B,T,W,N,R,U],styles:[".details-container[_ngcontent-%COMP%]{max-width:min(1100px,92vw);margin:0 auto;padding:0 1rem}h4[_ngcontent-%COMP%]{margin:0 0 .75rem;font-size:clamp(1.1rem,.7vw + 1rem,1.4rem)}.owner-actions[_ngcontent-%COMP%]{margin-top:.75rem;display:flex;gap:.5rem;justify-content:flex-end}.edit-box[_ngcontent-%COMP%]{margin-top:.9rem;padding:.9rem;border:1px solid var(--border);border-radius:10px;background:var(--bg-elev)}.edit-box[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.35rem;color:var(--muted);font-weight:600}.edit-box[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;border:1px solid var(--border);background:var(--bg-card);color:var(--text);border-radius:8px;padding:.6rem .7rem;outline:none}.edit-box[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{border-color:#3d444d;box-shadow:0 0 0 2px #58a6ff26}.edit-box[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:flex-end;margin-top:.6rem}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.4rem;padding:.45rem .8rem;border-radius:999px;border:1px solid var(--border);background:var(--bg-elev);color:var(--text);text-decoration:none;font-weight:600;transition:background .2s,border-color .2s,transform .02s}.btn[_ngcontent-%COMP%]:hover{border-color:#3d444d;background:#11161a;transform:translateY(-1px)}.btn.danger[_ngcontent-%COMP%]{background:#2b0f14;border-color:#712b2f;color:#ffb4b4}.btn.danger[_ngcontent-%COMP%]:hover{background:#3a1419;border-color:#8b373c}.btn-neutral[_ngcontent-%COMP%]{background:var(--bg-card)}.btn-accent[_ngcontent-%COMP%]{background:var(--accent);color:#0b1220;border-color:transparent}.btn-accent[_ngcontent-%COMP%]:hover{filter:brightness(1.05)}.muted[_ngcontent-%COMP%]{color:var(--muted)}"]})};export{F as DestinationDetails};
