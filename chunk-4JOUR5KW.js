import{a as E,b as C,c as k,d as N,f as I,g as T,i as V,j as F,l as R}from"./chunk-WY3CXWCY.js";import{U as w}from"./chunk-NJQ2NFC2.js";import{Da as x,F as f,G as u,Ma as O,Pa as S,U as l,W as p,X as P,da as s,fa as m,ia as _,ja as n,ka as o,la as y,ma as b,na as g,oa as c,pa as M,qa as r,ra as v}from"./chunk-6PUXLSNH.js";function G(t,i){if(t&1){let e=b();n(0,"div",5)(1,"label",6),r(2,"Name:"),o(),n(3,"span",7),r(4),o()(),n(5,"div",5)(6,"label",6),r(7,"Email:"),o(),n(8,"span",7),r(9),o()(),n(10,"div",8)(11,"button",9),g("click",function(){f(e);let a=c(3);return u(a.startEdit())}),r(12,"Edit name"),o()()}if(t&2){let e,d,a=c(3);l(4),v((e=a.profile())==null?null:e.displayName),l(5),v((d=a.profile())==null?null:d.email)}}function L(t,i){t&1&&(n(0,"p",14),r(1,"Name must be at least 5 characters."),o())}function D(t,i){if(t&1){let e=b();n(0,"form",10),g("ngSubmit",function(){f(e);let a=c(3);return u(a.save())}),n(1,"div",5)(2,"label",11),r(3,"Name:"),o(),n(4,"div",12),y(5,"input",13),s(6,L,2,0,"p",14),o()(),n(7,"div",8)(8,"button",15),g("click",function(){f(e);let a=c(3);return u(a.cancelEdit())}),r(9,"Cancel"),o(),n(10,"button",16),r(11,"Save"),o()()()}if(t&2){let e=c(3);_("formGroup",e.form),l(5),M("input-error",e.nameInvalid),l(),m(e.nameInvalid?6:-1),l(4),_("disabled",e.form.invalid)}}function B(t,i){if(t&1&&(n(0,"div",2)(1,"h2",3),r(2,"My profile"),o(),s(3,G,13,2),s(4,D,12,5,"form",4),o()),t&2){let e=c(2);l(3),m(e.isEdit?-1:3),l(),m(e.isEdit?4:-1)}}function z(t,i){t&1&&(n(0,"div",1)(1,"h3"),r(2,"You\u2019re not logged in"),o(),n(3,"p"),r(4,"Please sign in to view your profile."),o()())}function A(t,i){if(t&1&&s(0,B,5,2,"div",2)(1,z,5,0,"div",1),t&2){let e=c();m(e.isLoggedIn()?0:1)}}function Y(t,i){t&1&&(n(0,"div",1)(1,"p"),r(2,"Loading your profile\u2026"),o()())}var j=class t{constructor(i,e,d,a){this.authService=i;this.router=e;this.formBuilder=d;this.title=a;this.authResolved=this.authService.authResolved,this.isLoggedIn=this.authService.isLoggedIn,this.profile=this.authService.profileSignal,this.form=this.formBuilder.nonNullable.group({displayName:["",[C.required,C.minLength(5)]]}),x(()=>{this.authResolved()&&!this.isLoggedIn()&&this.router.navigate(["/login"])}),x(()=>{let h=this.profile();!this.isEdit&&h&&this.form.patchValue({displayName:h.displayName??""},{emitEvent:!1})})}form;authResolved;isLoggedIn;profile;isEdit=!1;ngOnInit(){this.title.setTitle("Profile")}startEdit(){let i=this.profile();this.form.patchValue({displayName:i?.displayName??""}),this.isEdit=!0}cancelEdit(){this.isEdit=!1;let i=this.profile();this.form.reset({displayName:i?.displayName??""})}save(){if(this.form.invalid)return;let i=this.form.controls.displayName.value.trim();i&&this.authService.updateDisplayName$(i).subscribe({next:()=>{this.isEdit=!1},error:e=>console.error("Failed to update display name",e)})}get nameInvalid(){let i=this.form.controls.displayName;return i.invalid&&(i.dirty||i.touched)}static \u0275fac=function(e){return new(e||t)(p(w),p(S),p(F),p(O))};static \u0275cmp=P({type:t,selectors:[["app-profile"]],decls:3,vars:1,consts:[[1,"card","outer-container","profile-card"],[1,"card","profile-state"],[1,"inner-container"],[1,"profile-title"],[1,"edit-form",3,"formGroup"],[1,"kv-row"],[1,"key"],[1,"val","badge"],[1,"actions"],["type","button",1,"btn","btn-outline","btn--sm",3,"click"],[1,"edit-form",3,"ngSubmit","formGroup"],["for","displayName",1,"key"],[1,"field-col"],["id","displayName","formControlName","displayName","placeholder","Your display name"],[1,"error"],["type","button",1,"btn","btn-neutral",3,"click"],["type","submit",1,"btn","btn-accent",3,"disabled"]],template:function(e,d){e&1&&(n(0,"div",0),s(1,A,2,1)(2,Y,3,0,"div",1),o()),e&2&&(l(),m(d.authResolved()?1:2))},dependencies:[R,I,E,k,N,T,V],styles:['[_ngcontent-%COMP%]:root{--bg-card:#0d1117;--bg-elev:#161b22;--border:#30363d;--text:#c9d1d9;--muted:#8b949e;--accent:#58a6ff}.outer-container[_ngcontent-%COMP%]{margin:0 auto;max-width:min(640px,94vw);padding:2rem 1rem 3rem;display:flex;justify-content:center}.profile-card[_ngcontent-%COMP%]{width:100%;background:var(--bg-card);border:1px solid var(--border);border-radius:14px;box-shadow:0 12px 32px #00000059}.inner-container[_ngcontent-%COMP%]{padding:1.25rem}.profile-title[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:clamp(1.2rem,.8vw + 1rem,1.6rem);color:var(--text);position:relative}.profile-title[_ngcontent-%COMP%]:after{content:"";display:block;height:2px;width:72px;margin-top:.5rem;background:linear-gradient(90deg,var(--accent),transparent);border-radius:2px}.kv-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-bottom:.9rem}.profile-card[_ngcontent-%COMP%]   .key[_ngcontent-%COMP%]{color:var(--muted);font-weight:600;min-width:90px}.profile-card[_ngcontent-%COMP%]   .val[_ngcontent-%COMP%]{color:var(--text)}.badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.4rem;padding:.35rem .6rem;background:var(--bg-elev);border:1px solid var(--border);border-radius:999px;font-size:.92rem;line-height:1}.profile-state[_ngcontent-%COMP%]{margin:1rem;padding:1.25rem;background:var(--bg-card);border:1px dashed var(--border);border-radius:14px;text-align:center;color:var(--muted)}.inner-container[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{margin-bottom:0}.btn[_ngcontent-%COMP%]{--h: 38px;display:inline-flex;align-items:center;justify-content:center;gap:.5rem;height:var(--h);padding:0 .95rem;border-radius:10px;border:1px solid var(--border);background:var(--bg-elev);color:var(--text);font-weight:600;line-height:1;cursor:pointer;transition:transform .06s ease,box-shadow .15s ease,background .15s ease,border-color .15s ease}.btn[_ngcontent-%COMP%]:hover{border-color:#3b4450;background:#1b2230}.btn[_ngcontent-%COMP%]:active{transform:translateY(1px)}.btn[_ngcontent-%COMP%]:disabled{opacity:.55;cursor:not-allowed}.btn--sm[_ngcontent-%COMP%]{--h: 32px;padding:0 .7rem;font-size:.92rem}.btn-outline[_ngcontent-%COMP%]{background:transparent;border-color:var(--border);color:var(--text)}.btn-outline[_ngcontent-%COMP%]:hover{border-color:var(--accent);box-shadow:0 0 0 3px #58a6ff26}.btn-neutral[_ngcontent-%COMP%]{background:var(--bg-elev);border-color:var(--border)}.btn-neutral[_ngcontent-%COMP%]:hover{border-color:#3b4450;background:#1b2230}.btn-accent[_ngcontent-%COMP%]{background:#1f6feb;border-color:#316dca;color:#fff;box-shadow:0 6px 18px #1f6feb40}.btn-accent[_ngcontent-%COMP%]:hover{box-shadow:0 8px 22px #1f6feb59;filter:brightness(1.03)}.edit-form[_ngcontent-%COMP%]{margin-top:.75rem;padding:.9rem;border:1px dashed var(--border);border-radius:12px;background:linear-gradient(180deg,rgba(88,166,255,.06),transparent 120%)}.edit-form[_ngcontent-%COMP%]   .kv-row[_ngcontent-%COMP%]{margin-bottom:.8rem}.field-col[_ngcontent-%COMP%]{flex:1 1 auto}.edit-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;background:var(--bg-elev);color:var(--text);border:1px solid var(--border);border-radius:10px;padding:.55rem .7rem}.edit-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--accent);box-shadow:0 0 0 3px #58a6ff26}.input-error[_ngcontent-%COMP%]{border-color:#f85149!important;box-shadow:0 0 0 3px #f851491f}.error[_ngcontent-%COMP%]{color:#f85149;font-size:.85rem;margin-top:.35rem}.actions[_ngcontent-%COMP%]{margin-top:.6rem;display:flex;gap:.6rem;justify-content:flex-end}']})};export{j as Profile};
