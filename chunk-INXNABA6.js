import{a as re}from"./chunk-62HOSM4N.js";import{D as X,F as Z,G as V,H as ee,I as te,K as j,L as ne,M as ie,N as S,Q as N,R as oe,T as R,U as M}from"./chunk-7MOMSB6F.js";import{B as Y,C as p,Ea as K,Fa as c,Ga as d,I as q,J as G,Ka as y,R as k,Ra as D,W as H,X as a,Ya as Q,aa as P,h as v,ha as J,ia as E,ka as F,na as l,o as z,oa as o,p as u,pa as r,q as f,qa as x,r as b,sa as $,ta as W,u as C,v as h,va as O,wa as s,xa as m,y as U,ya as _}from"./chunk-6BN2QRS5.js";var I=class i{constructor(e){this.firestore=e}userCollectionsPath="users";destinationsPath="destinations";getWantToVisit$(e){let t=j(this.firestore,`${this.userCollectionsPath}/${e}/wantToVisit`);return V(t,{idField:"id"})}hasWantToVisit$(e,t){let n=S(this.firestore,`${this.userCollectionsPath}/${e}/wantToVisit/${t}`);return ee(n).pipe(f(g=>g.exists()))}addWantToVisit$(e,t){let n=S(this.firestore,`${this.userCollectionsPath}/${e}/wantToVisit/${t.id}`);return z(oe(n,t))}removeWantToVisit$(e,t){let n=S(this.firestore,`${this.userCollectionsPath}/${e}/wantToVisit/${t}`);return z(ie(n))}getAddedByYou$(e){let t=j(this.firestore,this.destinationsPath),n=N(t,R("authorId","==",e));return V(n,{idField:"id"})}getLikedByUser$(e){let t=ne(this.firestore,"likes"),n=N(t,R("uid","==",e));return Z(n).pipe(h(g=>{let T=g.map(w=>w.ref.parent.parent).filter(w=>!!w);if(!T.length)return u([]);let ce=T.map(w=>te(w,{idField:"id"}));return b(ce)}))}static \u0275fac=function(t){return new(t||i)(Y(X))};static \u0275prov=U({token:i,factory:i.\u0275fac,providedIn:"root"})};var L=class i{authService=p(M);destService=p(re);destId;destId$=new v(null);uid$=new v(null);uidPresent$=this.uid$.pipe(f(e=>!!e));likesCount$=this.destId$.pipe(h(e=>e?this.destService.likesCount$(e):u(0)));hasLiked$=b([this.destId$,this.uid$]).pipe(h(([e,t])=>e&&t?this.destService.hasLiked$(e,t):u(!1)));constructor(){y(()=>{let e=this.authService.userSignal();this.uid$.next(e?.uid??null)})}ngOnChanges(e){e.destId&&this.destId$.next(this.destId??null)}toggleLike(){let e=this.destId$.value,t=this.uid$.value;if(!e||!t){console.error("Missing destination || user ids"),console.log(`Destination id -> ${e} | User id -> ${t}`);return}this.hasLiked$.pipe(C(1)).subscribe(n=>{(n?this.destService.unlike$(e,t):this.destService.like$(e,t)).pipe(C(1)).subscribe()})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=P({type:i,selectors:[["app-like-button"]],inputs:{destId:"destId"},features:[k],decls:14,vars:16,consts:[["type","button",1,"like-btn",3,"click","disabled"],["aria-hidden","true",1,"icon"],["viewBox","0 0 24 24","width","18","height","18","focusable","false"],["d","M12.1 21.35l-1.1-1.01C5.14 15.24 2 12.39 2 8.99 2 6.42 4.02 4.4 6.59 4.4c1.53 0 3.01.7 3.96 1.82A5.27 5.27 0 0 1 14.5 4.4C17.03 4.4 19 6.37 19 8.9c0 3.44-3.15 6.28-8.9 11.45z","fill","none","stroke","currentColor","stroke-width","1.6",1,"heart-outline"],["d","M12.1 21.35l-1.1-1.01C5.14 15.24 2 12.39 2 8.99 2 6.42 4.02 4.4 6.59 4.4c1.53 0 3.01.7 3.96 1.82A5.27 5.27 0 0 1 14.5 4.4C17.03 4.4 19 6.37 19 8.9c0 3.44-3.15 6.28-8.9 11.45z",1,"heart-fill"],[1,"label"],[1,"count"]],template:function(t,n){t&1&&(o(0,"button",0),c(1,"async"),c(2,"async"),c(3,"async"),$("click",function(){return n.toggleLike()}),o(4,"span",1),q(),o(5,"svg",2),x(6,"path",3)(7,"path",4),r()(),G(),o(8,"span",5),s(9),c(10,"async"),r(),o(11,"span",6),s(12),c(13,"async"),r()()),t&2&&(O("liked",d(1,6,n.hasLiked$)),l("disabled",!d(2,8,n.uidPresent$)),J("aria-pressed",d(3,10,n.hasLiked$)?"true":"false"),a(9),_(" ",d(10,12,n.hasLiked$)?"Liked":"Like"," "),a(3),m(d(13,14,n.likesCount$)??0))},dependencies:[D],styles:["[_ngcontent-%COMP%]:root{--fg:#e6e6e6;--muted:#9aa3af;--btn-bg:rgba(255,255,255,.06);--btn-border:rgba(255,255,255,.12);--accent:#ff4d8d;--accent-bg:rgba(255,77,141,.16);--accent-border:rgba(255,77,141,.35)}.like-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.4rem .7rem;border-radius:999px;background:var(--btn-bg);border:1px solid var(--btn-border);color:var(--fg);cursor:pointer;transition:background .2s,border-color .2s,transform .05s;font:500 .9rem/1 system-ui,-apple-system,Segoe UI,Roboto,sans-serif}.like-btn[_ngcontent-%COMP%]:hover{background:#ffffff17}.like-btn[_ngcontent-%COMP%]:active{transform:translateY(1px)}.like-btn[disabled][_ngcontent-%COMP%]{opacity:.55;cursor:not-allowed}.icon[_ngcontent-%COMP%]{width:18px;height:18px;display:inline-grid;place-items:center}.heart-fill[_ngcontent-%COMP%]{display:none;fill:var(--accent)}.heart-outline[_ngcontent-%COMP%]{stroke:var(--muted)}.like-btn[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{min-width:1.35rem;padding:0 .4rem;text-align:center;border-radius:999px;font-variant-numeric:tabular-nums;background:#ffffff14;border:1px solid var(--btn-border)}.like-btn.liked[_ngcontent-%COMP%]{color:#ffd8e7;background:var(--accent-bg);border-color:var(--accent-border)}.like-btn.liked[_ngcontent-%COMP%]   .heart-fill[_ngcontent-%COMP%]{display:block}.like-btn.liked[_ngcontent-%COMP%]   .heart-outline[_ngcontent-%COMP%]{display:none}.like-btn.liked[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{background:#ff4d8d38;border-color:var(--accent-border)}"]})};var B=class i{destination;collectionService=p(I);authService=p(M);dest$=new v(null);destId$=this.dest$.pipe(f(e=>e?.id??null));uid$=new v(null);uidPresent$=this.uid$.pipe(f(Boolean));constructor(){y(()=>{let e=this.authService.userSignal();this.uid$.next(e?.uid??null)})}ngOnChanges(e){e.destination&&this.dest$.next(this.destination??null)}has$=b([this.uid$,this.destId$]).pipe(h(([e,t])=>e&&t?this.collectionService.hasWantToVisit$(e,t):u(!1)));toggle(){b([this.uid$,this.dest$,this.destId$,this.has$]).pipe(C(1)).subscribe(([e,t,n,g])=>{if(!e||!t||!n)return;(g?this.collectionService.removeWantToVisit$(e,n):this.collectionService.addWantToVisit$(e,t)).pipe(C(1)).subscribe()})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=P({type:i,selectors:[["app-wtv-button"]],inputs:{destination:"destination"},features:[k],decls:9,vars:13,consts:[["type","button","aria-label","Toggle want to visit",1,"wtv-btn",3,"click","disabled"],["aria-hidden","true",1,"icon"],[1,"label"]],template:function(t,n){t&1&&(o(0,"button",0),c(1,"async"),c(2,"async"),$("click",function(){return n.toggle()}),o(3,"span",1),s(4),c(5,"async"),r(),o(6,"span",2),s(7),c(8,"async"),r()()),t&2&&(O("added",d(1,5,n.has$)),l("disabled",!d(2,7,n.uidPresent$)),a(4),_(" ",d(5,9,n.has$)?"\u{1F4CC}":"\u2795"," "),a(3),m(d(8,11,n.has$)?"Saved":"Want to visit"))},dependencies:[D],styles:["[_ngcontent-%COMP%]:root{--bg-elev:#161b22;--border:#30363d;--text:#c9d1d9;--muted:#8b949e;--accent:#58a6ff;--pin:#f778ba}.wtv-btn[_ngcontent-%COMP%]{display:inline-grid;grid-auto-flow:column;grid-template-columns:1.25rem auto;align-items:center;gap:.5rem;background:var(--bg-elev);color:var(--text);border:1px solid var(--border);border-radius:12px;padding:.45rem .75rem;min-height:36px;cursor:pointer;min-width:10.5rem;white-space:nowrap;transition:border-color .15s,box-shadow .15s,transform .05s,background .15s}.wtv-btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:1.25rem;text-align:center;font-size:1rem;line-height:1}.wtv-btn[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:600;font-size:.9rem;color:var(--text)}.wtv-btn[_ngcontent-%COMP%]:hover:not(:disabled){border-color:var(--accent);box-shadow:0 0 0 3px #58a6ff26}.wtv-btn[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(1px)}.wtv-btn.added[_ngcontent-%COMP%]{background:linear-gradient(180deg,#f778ba1a,#f778ba0d);border-color:color-mix(in srgb,var(--pin) 40%,var(--border))}.wtv-btn.added[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#ffd6ea}.wtv-btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;box-shadow:none}@media (max-width:480px){.like-btn[_ngcontent-%COMP%]{min-width:2.4rem;padding:.45rem}.like-btn[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:none}}"]})};var de=i=>["/destinations",i];function le(i,e){if(i&1&&(o(0,"div",11),x(1,"app-like-button",13)(2,"app-wtv-button",14),r()),i&2){let t=W();a(),l("destId",t.destination.id),a(),l("destination",t.destination)}}function pe(i,e){if(i&1&&(o(0,"section",12)(1,"a",15),s(2," Details "),r()()),i&2){let t=W();a(),l("routerLink",K(1,de,t.destination.id))}}var se=class i{destination;showDetailsLink=!0;variant="card";compact=!1;authService=p(M);profile=this.authService.profileSignal;static \u0275fac=function(t){return new(t||i)};static \u0275cmp=P({type:i,selectors:[["app-destination-item"]],inputs:{destination:"destination",showDetailsLink:"showDetailsLink",variant:"variant",compact:"compact"},decls:21,vars:11,consts:[[1,"wrapper"],[1,"grid-container"],[1,"description"],[1,"destination-header"],[1,"location-name"],[1,"destination-image"],[1,"img-wrapper"],["alt","Photo of the destination",3,"src"],[1,"meta"],[1,"author"],[1,"badge"],[1,"actions"],[1,"destination-description"],[3,"destId"],[3,"destination"],[1,"btn",3,"routerLink"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"header",3)(4,"h5",4),s(5),r()(),o(6,"div")(7,"p"),s(8),r()()(),o(9,"figure",5)(10,"div",6),x(11,"img",7),r(),o(12,"figcaption"),s(13),r()(),o(14,"div",8)(15,"span",9),s(16,"Added by:"),r(),o(17,"span",10),s(18),r(),E(19,le,3,2,"div",11),r()(),E(20,pe,3,3,"section",12),r()),t&2&&(O("detail",n.variant==="detail")("compact",n.compact),a(5),m(n.destination.locationName),a(3),m(n.destination.description),a(3),l("src",n.destination.imgUrl,H),a(2),_("Photo by: ",n.destination.photoCredit),a(5),m(n.destination.authorName),a(),F(n.destination.id?19:-1),a(),F(n.showDetailsLink?20:-1))},dependencies:[Q,L,B],styles:['[_ngcontent-%COMP%]:root{--bg-card:#0d1117;--bg-elev:#161b22;--border:#30363d;--text:#c9d1d9;--muted:#8b949e;--accent:#58a6ff;--heart:#ea4c89}.wrapper[_ngcontent-%COMP%]{background:linear-gradient(180deg,#0d1117b3,#0d111773);border-radius:12px;padding:1rem;transition:border-color .2s,box-shadow .2s,transform .2s;position:relative;overflow:hidden;display:flex;flex-direction:column}.wrapper[_ngcontent-%COMP%]:hover{border-color:#3d444d;box-shadow:0 10px 32px #00000059;transform:translateY(-2px)}.grid-container[_ngcontent-%COMP%]{display:grid;gap:1rem;grid-template-columns:minmax(0,1fr) 320px;grid-template-areas:"desc image" "meta image";align-items:start;min-width:0}.description[_ngcontent-%COMP%]{grid-area:desc}.destination-image[_ngcontent-%COMP%]{grid-area:image;margin:0}.img-wrapper[_ngcontent-%COMP%]{position:relative;aspect-ratio:4/3;overflow:hidden;border-radius:10px;background:#0b1116}.img-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;transform:scale(1.02);transition:transform .4s ease}.wrapper[_ngcontent-%COMP%]:hover   .img-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transform:scale(1.06)}figcaption[_ngcontent-%COMP%]{margin-top:.5rem;color:var(--muted);font-size:.8rem;text-align:right}.destination-header[_ngcontent-%COMP%]   .location-name[_ngcontent-%COMP%]{margin:0 0 .35rem;font-size:clamp(1.1rem,1.2vw + .9rem,1.35rem);color:var(--text)}.description[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0 0;color:var(--text);display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:4;overflow:hidden}.meta[_ngcontent-%COMP%]{grid-area:meta;display:flex;align-items:center;gap:.6rem;flex-wrap:wrap;color:var(--muted);min-width:0}.badge[_ngcontent-%COMP%]{padding:.25rem .55rem;border:1px solid var(--border);border-radius:999px;background:#0f141a;color:var(--text);font-size:.75rem}.actions[_ngcontent-%COMP%]{margin-left:auto;display:flex;gap:.5rem;flex-wrap:wrap;min-width:0}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.4rem;padding:.45rem .7rem;border:1px solid var(--border);background:var(--bg-elev);color:var(--text);border-radius:999px;font-size:.85rem;font-weight:500;text-decoration:none;transition:background .2s,border-color .2s,transform .1s;max-width:100%;white-space:nowrap;box-sizing:border-box}.destination-description[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:.75rem}.destination-description[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{color:var(--accent)}.wrapper.detail[_ngcontent-%COMP%]{padding:1.25rem}.wrapper.detail[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]{grid-template-columns:minmax(0,1.2fr) 520px}.wrapper.detail[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{-webkit-line-clamp:unset;overflow:visible;white-space:normal;line-height:1.7;font-size:1rem}.wrapper.detail[_ngcontent-%COMP%]   .img-wrapper[_ngcontent-%COMP%]{aspect-ratio:16/10}.wrapper.detail[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{margin-top:1rem}.wrapper.compact[_ngcontent-%COMP%]{padding:.6rem}.wrapper.compact[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-template-areas:"image" "desc" "meta"}.wrapper.compact[_ngcontent-%COMP%]   .img-wrapper[_ngcontent-%COMP%]{aspect-ratio:16/10}.wrapper.compact[_ngcontent-%COMP%]   .destination-header[_ngcontent-%COMP%]   .location-name[_ngcontent-%COMP%]{font-size:1.05rem}.wrapper.compact[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{-webkit-line-clamp:1;font-size:.92rem}.wrapper.compact[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{font-size:.7rem;padding:.2rem .5rem}.wrapper.compact[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-left:0}.wrapper.compact[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .like-btn[_ngcontent-%COMP%]{padding:.35rem .55rem;font-size:.8rem}.wrapper.compact[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{margin-top:.35rem}.wrapper[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:focus-visible{outline:2px solid var(--accent);outline-offset:2px;border-radius:10px}@media (prefers-reduced-motion: reduce){*[_ngcontent-%COMP%]{transition:none!important}}@media (max-width:900px){.grid-container[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-template-areas:"image" "desc" "meta"}figcaption[_ngcontent-%COMP%]{text-align:left}.actions[_ngcontent-%COMP%]{margin-left:0}.wrapper.detail[_ngcontent-%COMP%]   .grid-container[_ngcontent-%COMP%]{grid-template-columns:1fr}.wrapper.detail[_ngcontent-%COMP%]   .img-wrapper[_ngcontent-%COMP%]{aspect-ratio:16/9}}.wrapper[_ngcontent-%COMP%]{container-type:inline-size}@container (max-width:520px){.grid-container[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-template-areas:"image" "desc" "meta"}figcaption[_ngcontent-%COMP%]{text-align:left}.actions[_ngcontent-%COMP%]{margin-left:0}}']})};export{I as a,se as b};
